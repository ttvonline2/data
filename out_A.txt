Ã tÆ°á»Ÿng tá»•ng quan

Khi nÃ o má»™t Ä‘oáº¡n Ä‘Æ°á»£c cá»™ng Ä‘iá»ƒm ?
â€“ Äá»™ dÃ i pháº£i â‰¥ 3 .
â€“ GiÃ¡ trá»‹ lá»›n nháº¥t á»Ÿ giá»¯a khÃ´ng Ä‘Æ°á»£c vÆ°á»£t quÃ¡ giÃ¡ trá»‹ nhá» hÆ¡n trong hai Ä‘áº§u Ä‘oáº¡n .
â†’ HÃ¬nh dung Ä‘áº§u â€œ tháº¥p â€ ( giÃ¡ trá»‹ nhá» hÆ¡n ) nhÆ° má»™t cÃ¡i náº¯p , má»i pháº§n tá»­ náº±m giá»¯a hai Ä‘áº§u pháº£i chui lá»t dÆ°á»›i cÃ¡i náº¯p Ä‘Ã³ .

Cá»‘ Ä‘á»‹nh Ä‘áº§u â€œ tháº¥p â€
Gá»i chá»‰ sá»‘ Ä‘áº§u tháº¥p lÃ  i ( giáº£ sá»­
<<< ğµ >>>
<<< ğ‘– >>>
â‰¤
<<< ğµ >>>
<<< ğ‘— >>>
B
i
â€‹
â‰¤ B
j
â€‹
) .
Äiá»u kiá»‡n trá»Ÿ thÃ nh :
â€“ Chá»n má»™t vá»‹ trÃ­ j > i + 1 .
â€“
<<< ğµ >>>
<<< ğ‘— >>>
â‰¥
<<< ğµ >>>
<<< ğ‘– >>>
B
j
â€‹
â‰¥ B
i
â€‹
( Ä‘áº§u cÃ²n láº¡i khÃ´ng tháº¥p hÆ¡n náº¯p ) .
â€“ Táº¥t cáº£ pháº§n tá»­ giá»¯a i vÃ  j Ä‘á»u â‰¤
<<< ğµ >>>
<<< ğ‘– >>>
B
i
â€‹
.

Khoanh Ä‘oáº¡n an toÃ n quanh má»—i vá»‹ trÃ­
Vá»›i má»—i vá»‹ trÃ­ i , tÃ¬m biÃªn trÃ¡i L [ i ] vÃ  biÃªn pháº£i R [ i ] gáº§n nháº¥t cÃ³ giÃ¡ trá»‹ >
<<< ğµ >>>
<<< ğ‘– >>>
B
i
â€‹
.
Trong Ä‘oáº¡n liÃªn tiáº¿p
[

<<< ğ¿ >>>
[
<<< ğ‘– >>>
]
+
1
,

<<< ğ‘… >>>
[
<<< ğ‘– >>>
]
âˆ’
1
]
[ L [ i ] + 1 , R [ i ] âˆ’ 1 ] má»i pháº§n tá»­ â‰¤
<<< ğµ >>>
<<< ğ‘– >>>
B
i
â€‹
.
â†’ Náº¿u j náº±m trong
[
<<< ğ‘– >>>
+
2
,

<<< ğ‘… >>>
[
<<< ğ‘– >>>
]
âˆ’
1
]
[ i + 2 , R [ i ] âˆ’ 1 ] thÃ¬ Ä‘iá»u kiá»‡n â€œ lá»t náº¯p â€ tá»± Ä‘áº£m báº£o .

L [ i ] , R [ i ] tÃ­nh nhanh báº±ng <<< s t a c k >>> Ä‘Æ¡n Ä‘iá»‡u ( duyá»‡t má»™t láº§n tá»« trÃ¡i qua pháº£i cho R , tá»« pháº£i sang trÃ¡i cho L ) .

Äáº¿m nhanh cÃ¡c j phÃ¹ há»£p
Duyá»‡t cÃ¡c vá»‹ trÃ­ theo giÃ¡ trá»‹ giáº£m dáº§n .
â€“ Nhá»¯ng chá»‰ sá»‘ Ä‘Ã£ duyá»‡t luÃ´n cÃ³
<<< ğµ >>>
<<< ğ‘˜ >>>
â‰¥
<<< ğµ >>>
<<< ğ‘– >>>
B
k
â€‹
â‰¥ B
i
â€‹
.
â€“ LÆ°u cÃ¡c chá»‰ sá»‘ Ä‘Ã£ duyá»‡t vÃ o má»™t cáº¥u trÃºc <<< F e n w i c k >>> / <<< S e g m e n t >>> <<< t r e e >>> vá»›i :
<<< B I T >>> â‚ : sá»‘ lÆ°á»£ng chá»‰ sá»‘ xáº¿p ( Ä‘á»ƒ biáº¿t cÃ³ bao nhiÃªu j ) .
<<< B I T >>> â‚‚ : tá»•ng vá»‹ trÃ­ xáº¿p ( Ä‘á»ƒ tÃ­nh nhanh tá»•ng Ä‘á»™ dÃ i ) .

Khi Ä‘ang á»Ÿ i :

Cáº§n thá»‘ng kÃª trong Ä‘oáº¡n
[
<<< ğ‘– >>>
+
2
,

<<< ğ‘… >>>
[
<<< ğ‘– >>>
]
âˆ’
1
]
[ i + 2 , R [ i ] âˆ’ 1 ] .

Láº¥y <<< c n t >>> = sá»‘ vá»‹ trÃ­ j trong Ä‘oáº¡n , <<< s u m I d x >>> = tá»•ng cÃ¡c vá»‹ trÃ­ Ä‘Ã³ .

Tá»•ng Ä‘iá»ƒm do i Ä‘Ã³ng gÃ³p lÃ 

âˆ‘
<<< ğ‘— >>>
(
<<< ğ‘— >>>
âˆ’
<<< ğ‘– >>>
+
1
)
=
<<< s u m I d x >>>
âˆ’
<<< c n t >>>
â‹…
<<< ğ‘– >>>
+
<<< c n t >>>
.
j
âˆ‘
â€‹
( j âˆ’ i + 1 ) = <<< s u m I d x >>> âˆ’ <<< c n t >>> â‹… i + <<< c n t >>> .
Sau khi cá»™ng , chÃ¨n i vÃ o hai <<< B I T >>> .

Äá»™ phá»©c táº¡p

TÃ­nh L , R :
<<< ğ‘‚ >>>
(
<<< ğ‘ >>>
)
O ( N ) .

Sáº¯p theo giÃ¡ trá»‹ vÃ  quÃ©t vá»›i <<< B I T >>> :
<<< ğ‘‚ >>>
(
<<< ğ‘ >>>
log
â¡
<<< ğ‘ >>>
)
O ( <<< N l o g N >>> ) .

Bá»™ nhá»›
<<< ğ‘‚ >>>
(
<<< ğ‘ >>>
)
O ( N ) .

Kiá»ƒm tra biÃªn
â€“ Máº£ng ngáº¯n hÆ¡n 3 pháº§n tá»­ luÃ´n cho káº¿t quáº£ 0 .
â€“ Khi
<<< ğ‘… >>>
[
<<< ğ‘– >>>
]
âˆ’
<<< ğ‘– >>>
<
2
R [ i ] âˆ’ i < 2 thÃ¬ bá» qua vÃ¬ khÃ´ng Ä‘á»§ Ä‘á»™ dÃ i .
â€“ ChÃº Ã½ dÃ¹ng chá»‰ sá»‘ 1 - <<< i n d e x >>> hay 0 - <<< i n d e x >>> nháº¥t quÃ¡n trong L , R vÃ  <<< B I T >>> .

TÃ³m táº¯t thao tÃ¡c

Vá»›i má»—i pháº§n tá»­ , tÃ¬m Ä‘oáº¡n â€œ an toÃ n â€ mÃ  nÃ³ lÃ m náº¯p ( dÃ¹ng <<< s t a c k >>> ) .

Duyá»‡t pháº§n tá»­ theo giÃ¡ trá»‹ giáº£m dáº§n , <<< B I T >>> lÆ°u cÃ¡c vá»‹ trÃ­ Ä‘Ã£ cao hÆ¡n hoáº·c báº±ng .

Má»—i láº§n láº¥y thá»‘ng kÃª trong Ä‘oáº¡n
[
<<< ğ‘– >>>
+
2
,
<<< ğ‘… >>>
[
<<< ğ‘– >>>
]
âˆ’
1
]
[ i + 2 , R [ i ] âˆ’ 1 ] Ä‘á»ƒ cá»™ng Ä‘iá»ƒm .

In tá»•ng Ä‘iá»ƒm sau khi xá»­ lÃ½ háº¿t máº£ng .

NhÆ° váº­y ta tÃ­nh Ä‘Æ°á»£c
âˆ‘
<<< ğ‘† >>>
<<< ğ‘– >>>
,
<<< ğ‘— >>>
âˆ‘ S
i , j
â€‹
cho máº£ng dÃ i tá»›i má»™t trÄƒm nghÃ¬n pháº§n tá»­ trong thá»i gian há»£p lÃ½ .